import { f as fail, r as redirect } from './index-Ddp2AB5f.js';
import { c as checkLoginUser, a as createUser } from './user-DHoF0IZE.js';
import './node-map-DHryaG8P.js';
import 'mongodb';

const actions = {
  //@ts-expect-error types not generated by svelte-kit
  login: async ({ cookies, request }) => {
    const data = await request.formData();
    const username = data.get("username");
    const password = data.get("password");
    console.log("Logging in user:", username, password);
    if (!await checkLoginUser(username, password)) {
      return fail(403, { loginfail: true, reason: "Invalid username or password" });
    }
    cookies.set("user", username, { path: "/" });
    throw redirect(303, "/");
  },
  //@ts-expect-error types not generated by svelte-kit
  register: async ({ cookies, request }) => {
    const data = await request.formData();
    const username = data.get("username");
    const password = data.get("password");
    console.log("Registering user:", username, password);
    const success = await createUser(username, password);
    if (!success) {
      return fail(403, { registerfail: true, reason: "Username already exists" });
    }
    cookies.set("user", username, { path: "/" });
    throw redirect(303, "/");
  },
  //@ts-expect-error types not generated by svelte-kit
  logout: ({ cookies }) => {
    cookies.set("user", "", { path: "/", maxAge: 0 });
    throw redirect(303, "/");
  }
};

var _page_server_ts = /*#__PURE__*/Object.freeze({
  __proto__: null,
  actions: actions
});

const index = 5;
let component_cache;
const component = async () => component_cache ??= (await import('./_page.svelte-D5sk4Kl4.js')).default;
const server_id = "src/routes/login/+page.server.ts";
const imports = ["_app/immutable/nodes/5.BauUdRlu.js","_app/immutable/chunks/scheduler.Cewbzyqj.js","_app/immutable/chunks/index.4GcxwhY7.js"];
const stylesheets = [];
const fonts = [];

export { component, fonts, imports, index, _page_server_ts as server, server_id, stylesheets };
//# sourceMappingURL=5-CGXQiR08.js.map
