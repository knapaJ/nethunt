{"version":3,"file":"7-D4qEQsSy.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/play/_node_id_/host/_page.server.ts.js","../../../.svelte-kit/adapter-node/nodes/7.js"],"sourcesContent":["import { g as getLoggedInUser, s as solvedNode } from \"../../../../../chunks/user.js\";\nimport { r as redirect, e as error } from \"../../../../../chunks/index.js\";\nimport { n as nodeByGameId, g as gameIdByNaturalId } from \"../../../../../chunks/node-map.js\";\nconst load = async ({ cookies, params }) => {\n  const user = await getLoggedInUser(cookies);\n  if (!user) throw redirect(303, \"/login\");\n  const node = await nodeByGameId(params.node_id);\n  if (!node) error(404, \"Connection reset\");\n  if (node?.type !== \"host\") redirect(303, `/play/${params.node_id}`);\n  if (!node.answer_text && !user.solved_nodes.includes(node.natural_id)) {\n    await solvedNode(node, user.username, false);\n  }\n  const options = [];\n  for (let i = 0; i < (node.answer_text?.length ?? 0); i++) {\n    options.push(i);\n  }\n  console.log(node.answer_text);\n  const neighbor_game_ids = await Promise.all(node.neighbours.map(async (neighbor_natural_id) => {\n    return await gameIdByNaturalId(neighbor_natural_id);\n  }));\n  return { props: {\n    name: node.name,\n    solved: user.solved_nodes.includes(node.natural_id),\n    description: node.description,\n    cipher_text: node.cipher_text,\n    options,\n    answer_description: node.answer_description,\n    neighbors: neighbor_game_ids,\n    goal: node.goal\n  } };\n};\nconst actions = {\n  submit: async ({ cookies, params, request }) => {\n    const data = await request.formData();\n    const user = await getLoggedInUser(cookies);\n    const node = await nodeByGameId(params.node_id);\n    if (!user) return error(401, \"Unauthorized\");\n    if (!node) return error(404, \"Connection reset\");\n    for (let i = 0; i < (node.answer_text?.length ?? 0); i++) {\n      const answer = data.get(`${i}`);\n      if (node.answer_text[i] !== answer) {\n        return { form_message: \"Wrong answer\" };\n      }\n    }\n    await solvedNode(node, user.username, false);\n  }\n};\nexport {\n  actions,\n  load\n};\n","import * as server from '../entries/pages/play/_node_id_/host/_page.server.ts.js';\n\nexport const index = 7;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/play/_node_id_/host/_page.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/play/[node_id]/host/+page.server.ts\";\nexport const imports = [\"_app/immutable/nodes/7.DpQXgyw8.js\",\"_app/immutable/chunks/scheduler.Cewbzyqj.js\",\"_app/immutable/chunks/index.4GcxwhY7.js\",\"_app/immutable/chunks/each.D6YF6ztN.js\"];\nexport const stylesheets = [];\nexport const fonts = [];\n"],"names":[],"mappings":"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"}