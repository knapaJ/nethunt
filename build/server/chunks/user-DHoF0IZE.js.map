{"version":3,"file":"user-DHoF0IZE.js","sources":["../../../.svelte-kit/adapter-node/chunks/user.js"],"sourcesContent":["import { d as db, g as gameIdByNaturalId } from \"./node-map.js\";\nasync function getLoggedInUser(cookies) {\n  const cookieUser = cookies.get(\"user\");\n  if (!cookieUser) return null;\n  const userCollection = db.collection(\"users\");\n  const user = await userCollection.findOne({ username: cookieUser });\n  if (!user) return null;\n  return user;\n}\nasync function createUser(username, password) {\n  const userCollection = db.collection(\"users\");\n  const existingUser = await userCollection.findOne({ username });\n  if (existingUser) return false;\n  await userCollection.insertOne({ username, password, solved_fw: [], solved_nodes: [], found_nodes: [], visible_nodes: [\"1\"] });\n  return true;\n}\nasync function checkLoginUser(username, password) {\n  const userCollection = db.collection(\"users\");\n  const user = await userCollection.findOne({ username, password });\n  return !!user;\n}\nasync function addToVisibleNodes(username, node_id) {\n  const userCollection = db.collection(\"users\");\n  await userCollection.updateOne({ username }, { $push: { visible_nodes: node_id } });\n}\nasync function solvedNode(node, username, firewall = false) {\n  for (const neighbor_natural_id of node.neighbours) {\n    const neighbor_id = await gameIdByNaturalId(neighbor_natural_id);\n    if (!neighbor_id) throw new Error(\"Neighbor not found\");\n    await addToVisibleNodes(username, neighbor_id);\n  }\n  if (firewall) {\n    const userCollection = db.collection(\"users\");\n    await userCollection.updateOne({ username }, { $push: { solved_fw: await gameIdByNaturalId(node.natural_id) } });\n  } else {\n    const userCollection = db.collection(\"users\");\n    await userCollection.updateOne({ username }, { $push: { solved_nodes: node.natural_id } });\n  }\n}\nexport {\n  createUser as a,\n  checkLoginUser as c,\n  getLoggedInUser as g,\n  solvedNode as s\n};\n"],"names":[],"mappings":";;AACA,eAAe,eAAe,CAAC,OAAO,EAAE;AACxC,EAAE,MAAM,UAAU,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACzC,EAAE,IAAI,CAAC,UAAU,EAAE,OAAO,IAAI,CAAC;AAC/B,EAAE,MAAM,cAAc,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAChD,EAAE,MAAM,IAAI,GAAG,MAAM,cAAc,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAC;AACtE,EAAE,IAAI,CAAC,IAAI,EAAE,OAAO,IAAI,CAAC;AACzB,EAAE,OAAO,IAAI,CAAC;AACd,CAAC;AACD,eAAe,UAAU,CAAC,QAAQ,EAAE,QAAQ,EAAE;AAC9C,EAAE,MAAM,cAAc,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAChD,EAAE,MAAM,YAAY,GAAG,MAAM,cAAc,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,CAAC,CAAC;AAClE,EAAE,IAAI,YAAY,EAAE,OAAO,KAAK,CAAC;AACjC,EAAE,MAAM,cAAc,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,EAAE,EAAE,YAAY,EAAE,EAAE,EAAE,WAAW,EAAE,EAAE,EAAE,aAAa,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;AACjI,EAAE,OAAO,IAAI,CAAC;AACd,CAAC;AACD,eAAe,cAAc,CAAC,QAAQ,EAAE,QAAQ,EAAE;AAClD,EAAE,MAAM,cAAc,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAChD,EAAE,MAAM,IAAI,GAAG,MAAM,cAAc,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;AACpE,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC;AAChB,CAAC;AACD,eAAe,iBAAiB,CAAC,QAAQ,EAAE,OAAO,EAAE;AACpD,EAAE,MAAM,cAAc,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAChD,EAAE,MAAM,cAAc,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,aAAa,EAAE,OAAO,EAAE,EAAE,CAAC,CAAC;AACtF,CAAC;AACD,eAAe,UAAU,CAAC,IAAI,EAAE,QAAQ,EAAE,QAAQ,GAAG,KAAK,EAAE;AAC5D,EAAE,KAAK,MAAM,mBAAmB,IAAI,IAAI,CAAC,UAAU,EAAE;AACrD,IAAI,MAAM,WAAW,GAAG,MAAM,iBAAiB,CAAC,mBAAmB,CAAC,CAAC;AACrE,IAAI,IAAI,CAAC,WAAW,EAAE,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC;AAC5D,IAAI,MAAM,iBAAiB,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;AACnD,GAAG;AACH,EAAE,IAAI,QAAQ,EAAE;AAChB,IAAI,MAAM,cAAc,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAClD,IAAI,MAAM,cAAc,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,SAAS,EAAE,MAAM,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,CAAC,CAAC;AACrH,GAAG,MAAM;AACT,IAAI,MAAM,cAAc,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAClD,IAAI,MAAM,cAAc,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;AAC/F,GAAG;AACH;;;;"}